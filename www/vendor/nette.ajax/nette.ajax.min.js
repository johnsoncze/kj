!function(l,p,m){if("function"!=typeof p)return console.error("nette.ajax.js: jQuery is missing, load it please");p.nette=new(p.extend(function(){var f={self:this,initialized:!1,contexts:{},on:{init:{},load:{},prepare:{},before:{},start:{},success:{},complete:{},error:{}},fire:function(){var n=!0,r=Array.prototype.slice.call(arguments),t=r.shift(),e="string"==typeof t?t:t.name,o="object"==typeof t&&t.off||{};return r.push(f.self),p.each(f.on[e],function(t,e){if(e===m||-1!==p.inArray(t,o))return!0;var i=e.apply(f.contexts[t],r);return n=i===m||i}),n},requestHandler:function(t){var e=f.self.ajax({},this,t);if(e&&e._returnFalse)return!1},ext:function(t,e,i){for(;!i;)i="ext_"+Math.random(),f.contexts[i]&&(i=m);p.each(t,function(t,e){f.on[t][i]=e}),f.contexts[i]=p.extend(e||{},{name:function(){return i},ext:function(t,e){var i=f.contexts[t];if(!i&&e)throw"Extension '"+this.name()+"' depends on disabled extension '"+t+"'.";return i}})}};this.ext=function(i,t,e){if("object"==typeof i)f.ext(i,t);else{if(t===m)return f.contexts[i];if(t){if("string"==typeof i&&f.contexts[i]!==m)throw"Cannot override already registered nette-ajax extension '"+i+"'.";f.ext(t,e,i)}else p.each(["init","load","prepare","before","start","success","complete","error"],function(t,e){f.on[e][i]=m}),f.contexts[i]=m}return this},this.init=function(t,e){if(f.initialized)throw"Cannot initialize nette-ajax twice.";if("function"==typeof t)this.ext("init",null),this.ext("init",{load:t},e);else if("object"==typeof t)this.ext("init",null),this.ext("init",t,e);else if(t!==m)throw"Argument of init() can be function or function-hash only.";return f.initialized=!0,f.fire("init"),this.load(),this},this.load=function(){return f.fire("load",f.requestHandler),this},this.ajax=function(t,e,i){if("string"===p.type(t)&&(t={url:t}),!t.nette&&e&&i){var n,r=p(e),o=t.nette={e:i,ui:e,el:r,isForm:r.is("form"),isSubmit:r.is("input[type=submit]")||r.is("button[type=submit]"),isImage:r.is("input[type=image]"),form:null};if(o.isSubmit||o.isImage?o.form=o.el.closest("form"):o.isForm&&(o.form=o.el),t.url||(t.url=o.form?o.form.attr("action")||l.location.pathname+l.location.search:e.href),t.type||(t.type=o.form?o.form.attr("method"):"get"),r.is("[data-ajax-off]")){var a=r.attr("data-ajax-off");0===a.indexOf("[")?t.off=r.data("ajaxOff"):-1!==a.indexOf(",")?t.off=a.split(","):-1!==a.indexOf(" ")?t.off=a.split(" "):t.off=a,"string"==typeof t.off&&(t.off=[t.off]),t.off=p.grep(p.each(t.off,function(t){return p.trim(t)}),function(t){return t.length})}}return f.fire({name:"prepare",off:t.off||{}},t),t.prepare&&t.prepare(t),n=t.beforeSend,t.beforeSend=function(t,e){var i=f.fire({name:"before",off:e.off||{}},t,e);return(i||i===m)&&n&&(i=n(t,e)),i},this.handleXHR(p.ajax(t),t)},this.handleXHR=function(t,n){return n=n||{},!t||void 0!==t.statusText&&"canceled"===t.statusText||(t.done(function(t,e,i){f.fire({name:"success",off:n.off||{}},t,e,i,n)}).fail(function(t,e,i){f.fire({name:"error",off:n.off||{}},t,e,i,n)}).always(function(t,e){f.fire({name:"complete",off:n.off||{}},t,e,n)}),f.fire({name:"start",off:n.off||{}},t,n),n.start&&n.start(t,n)),t}},p.nette?p.nette:{})),p.fn.netteAjax=function(t,e){return p.nette.ajax(e||{},this[0],t)},p.fn.netteAjaxOff=function(){return this.off(".nette")},p.nette.ext("validation",{before:function(t,e){if(!e.nette)return!0;var i=e.nette,n=i.e,r=p.extend(this.defaults,e.validate||function(){if(i.el.is("[data-ajax-validate]")){var t=i.el.data("ajaxValidate");return!1===t?{keys:!1,url:!1,form:!1}:"object"==typeof t?t:void 0}}()||{}),o=!1;if(i.el.attr("data-ajax-pass")!==m&&(o="bool"!=typeof(o=i.el.data("ajaxPass"))||o),r.keys){var a=n.button||n.ctrlKey||n.shiftKey||n.altKey||n.metaKey;if(i.form){if(a&&i.isSubmit)return!(this.explicitNoAjax=!0);if(i.isForm&&this.explicitNoAjax)return this.explicitNoAjax=!1}else if(a)return!1}if(r.form&&i.form){var f;if((i.isSubmit||i.isImage)&&(i.form.get(0)["nette-submittedBy"]=i.el.get(0)),void 0===Nette.version||"2.3"==Nette.version){var s=this.ie();f=i.form.get(0).onsubmit&&!1===i.form.get(0).onsubmit(void 0!==s&&s<9?m:n)}else f=!1===(i.form.get(0).onsubmit?i.form.triggerHandler("submit"):Nette.validateForm(i.form.get(0)));if(f)return n.stopImmediatePropagation(),n.preventDefault(),!1}if(r.url){var u=i.form?e.url:i.el.attr("href");if(/(?:^[a-z][a-z0-9+.-]*:|\/\/)/.test(u)){var c=new URL(u);if(/:|^#/.test(c.pathname+c.search+c.hash))return!1}else if(/:|^#/.test(u))return!1}return o||(n.stopPropagation(),n.preventDefault(),t._returnFalse=!0),!0}},{defaults:{keys:!0,url:!0,form:!0},explicitNoAjax:!1,ie:function(t){for(var e=3,i=document.createElement("div"),n=i.getElementsByTagName("i");i.innerHTML="\x3c!--[if gt IE "+ ++e+"]><i></i><![endif]--\x3e",n[0];);return 4<e?e:t}}),p.nette.ext("forms",{init:function(){var t;l.Nette&&(t=this.ext("snippets"))&&t.after(function(t){t.find("form").each(function(){l.Nette.initForm(this)})})},prepare:function(t){var e=t.nette;if(e&&e.form){var i=e.e,n=t.data||{},r={};if(e.isSubmit)r[e.el.attr("name")]=e.el.val()||"";else if(e.isImage){var o=e.el.offset(),a=e.el.attr("name"),f=[Math.max(0,i.pageX-o.left),Math.max(0,i.pageY-o.top)];-1!==a.indexOf("[",0)?r[a]=f:(r[a+".x"]=f[0],r[a+".y"]=f[1])}var s=e.form.attr("method");if(s&&"post"===s.toLowerCase()&&"FormData"in l){var u=new FormData(e.form[0]);for(var c in r)u.append(c,r[c]);if("string"!=typeof n)for(var c in n)u.append(c,n[c]);t.data=u,t.processData=!1,t.contentType=!1}else"string"!=typeof n&&(n=p.param(n)),r=p.param(r),t.data=e.form.serialize()+(r?"&"+r:"")+"&"+n}}}),p.nette.ext("snippets",{success:function(t){t.snippets&&this.updateSnippets(t.snippets)}},{beforeQueue:p.Callbacks(),afterQueue:p.Callbacks(),completeQueue:p.Callbacks(),before:function(t){this.beforeQueue.add(t)},after:function(t){this.afterQueue.add(t)},complete:function(t){this.completeQueue.add(t)},updateSnippets:function(t,e){var i=this,n=[];for(var r in t){var o=this.getElement(r);o.get(0)&&n.push(o.get(0)),this.updateSnippet(o,t[r],e)}p(n).promise().done(function(){i.completeQueue.fire()})},updateSnippet:function(t,e,i){t.is("title")?document.title=e:(this.beforeQueue.fire(t),this.applySnippet(t,e,i),this.afterQueue.fire(t))},getElement:function(t){return p("#"+this.escapeSelector(t))},applySnippet:function(t,e,i){!i&&t.is("[data-ajax-append]")?t.append(e):!i&&t.is("[data-ajax-prepend]")?t.prepend(e):(t.html()!=e||/<[^>]*script/.test(e))&&t.html(e)},escapeSelector:function(t){return t.replace(/[\!"#\$%&'\(\)\*\+,\.\/:;<=>\?@\[\\\]\^`\{\|\}~]/g,"\\$&")}}),p.nette.ext("redirect",{success:function(t){if(t.redirect)return l.location.href=t.redirect,!1}}),p.nette.ext("state",{success:function(t){t.state&&(this.state=t.state)}},{state:null}),p.nette.ext("unique",{start:function(t){this.xhr&&this.xhr.abort(),this.xhr=t},complete:function(){this.xhr=null}},{xhr:null}),p.nette.ext("abort",{init:function(){p("body").keydown(p.proxy(function(t){this.xhr&&"27"===t.keyCode.toString()&&!(t.ctrlKey||t.shiftKey||t.altKey||t.metaKey)&&this.xhr.abort()},this))},start:function(t){this.xhr=t},complete:function(){this.xhr=null}},{xhr:null}),p.nette.ext("load",{success:function(){p.nette.load()}}),p.nette.ext("init",{load:function(t){p(this.linkSelector).off("click.nette",t).on("click.nette",t),p(this.formSelector).off("submit.nette",t).on("submit.nette",t).off("click.nette",":image",t).on("click.nette",":image",t).off("click.nette",":submit",t).on("click.nette",":submit",t),p(this.buttonSelector).closest("form").off("click.nette",this.buttonSelector,t).on("click.nette",this.buttonSelector,t)}},{linkSelector:"a.ajax",formSelector:"form.ajax",buttonSelector:'input.ajax[type="submit"], button.ajax[type="submit"], input.ajax[type="image"]'})}(window,window.jQuery);